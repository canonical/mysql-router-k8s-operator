>This is part of the [Charmed MySQL Tutorial](/t/12176). Please refer to this page for more information and the overview of the content.

# Enable encryption with TLS

[Transport Layer Security (TLS)](https://en.wikipedia.org/wiki/Transport_Layer_Security) is a protocol used to encrypt data exchanged between two applications. Essentially, it secures data transmitted over a network.

Typically, enabling TLS internally within a highly available database or between a highly available database and client/server applications requires a high level of expertise. This has all been encoded into Charmed MySQL Router K8s so that configuring TLS requires minimal effort on your end.

TLS is enabled by integrating Charmed MySQL Router K8s with the [Self Signed Certificates Charm](https://charmhub.io/self-signed-certificates). This charm centralises TLS certificate management consistently and handles operations like providing, requesting, and renewing TLS certificates.

In this section, you will learn how to enable security in your MySQL Router K8s deployment using TLS encryption.

[note type="caution"]
**[Self-signed certificates](https://en.wikipedia.org/wiki/Self-signed_certificate) are not recommended for a production environment.**

Check [this guide](/t/11664) for an overview of the TLS certificates charms available. 
[/note]

---

## Enable TLS
Before enabling TLS on Charmed MySQL Router K8s, we must first deploy the `self-signed-certificates`  charm:
```shell
juju deploy self-signed-certificates --config ca-common-name="Tutorial CA"
```

Wait until `self-signed-certificates` is up and active with `juju status --watch 1s` to monitor the progress.
<!---```shell
TODO
```--->

To enable TLS on `mysql-router-k8s`, relate the two applications:
```shell
juju relate mysql-router-k8s self-signed-certificates
```
### Check the TLS certificate in use
Use `openssl` to connect to the MySQL through MySQL Router and check the TLS certificate in use:
```shell
> openssl s_client -starttls mysql -connect 10.1.84.74:3306 | grep Issuer
...
depth=1 C = US, CN = Tutorial CA
...
```
Congratulations! Your connection is now using TLS certificate generated by the external application `self-signed-certificates`.


## Disable TLS
To remove the external TLS and return to the locally generated one, remove the integration:
```shell
juju remove-relation mysql-router-k8s self-signed-certificates
```

### Check the TLS certificate in use
```shell
> openssl s_client -starttls mysql -connect 10.1.84.74:3306 | grep Issuer
```

The output should be similar to:
```shell
...
Issuer: CN = MySQL_Server_8.0.31_Auto_Generated_CA_Certificate
...
```
The MySQL Router K8s application reverted to the certificate that was created locally during the MySQL server installation.